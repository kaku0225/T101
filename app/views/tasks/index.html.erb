<%= flash[:notice] if flash %>

<%= form_tag({ controller: "tasks", action: "index" }, method: "get") do %>
  <%= label_tag(:q, "狀態搜尋:") %>
  <%= text_field_tag(:q) %>
  <%= submit_tag("搜尋") %>
<% end %>

<%= form_tag(tasks_path, method: "get") do %>
  <%= radio_button_tag(:order, "endtime_asc") %>
  <%= label_tag(:按照結束時間舊新排序) %>
  <%= radio_button_tag(:order, "endtime_desc") %>
  <%= label_tag(:按照結束時間新舊排序) %>

  <%= submit_tag("排序") %>
<% end %>

<h1>任務列表</h1>

<%= link_to '新增任務', new_task_path %>


<table>
  <tr>
    <td>任務</td>
    <td>內容</td>
    <td>任務結束時間</td>
    <td>任務狀態</td>
    <td>優先順序</td>
  </tr>
  <% @tasks.each do |task| %>
    <tr>
      <td><%= link_to task.name, task_path(task.id) %></td>
      <td><%= task.content %></td>
      <td><%= task.endtime.time.strftime('%Y-%m-%d') %></td>
      <td><%= task.state %></td>
      <td><%= task.priority %></td>
      <td><%= link_to '編輯', edit_task_path(task.id) %></td>
      <td><%= link_to '刪除', task_path(task.id), method:'delete', data: {confirm:'確定刪除？'} %></td>
      <td><%= link_to '更新狀態', state_update_task_path(task.id), method:'put' %></td>
      <td><%= task.id %></td>
    </tr>
  <% end %>
</table>